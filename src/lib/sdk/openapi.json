{
  "openapi": "3.0.0",
  "info": {
    "title": "Scalius Commerce API",
    "version": "1.0.0",
    "description": "API for the Scalius Commerce platform. This specification provides all the necessary details to build a complete e-commerce storefront, from displaying products and categories to processing orders and managing customer data.",
    "contact": {
      "name": "Scalius Support",
      "url": "https://scalius.com/support"
    }
  },
  "servers": [
    {
      "url": "/api/v1",
      "description": "API v1"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "A short-lived JSON Web Token obtained from the /auth/token endpoint."
      },
      "apiToken": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Token",
        "description": "A static, pre-shared token for machine-to-machine authentication to obtain a JWT."
      }
    },
    "schemas": {
      "Error": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": false
          },
          "error": {
            "type": "string",
            "example": "Error Type"
          },
          "message": {
            "type": "string",
            "example": "A detailed error message."
          }
        }
      },
      "Success": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "object"
          }
        }
      },
      "OrderPostRequest": {
        "type": "object",
        "required": [
          "customerName",
          "customerPhone",
          "shippingAddress",
          "city",
          "zone",
          "items",
          "shippingCharge"
        ],
        "properties": {
          "customerName": {
            "type": "string",
            "minLength": 3,
            "maxLength": 100
          },
          "customerPhone": {
            "type": "string",
            "pattern": "^(+88)?01[3-9]d{8}$"
          },
          "customerEmail": {
            "type": "string",
            "format": "email",
            "nullable": true
          },
          "shippingAddress": {
            "type": "string",
            "minLength": 10,
            "maxLength": 500
          },
          "city": {
            "type": "string",
            "description": "City ID from /locations/cities."
          },
          "zone": {
            "type": "string",
            "description": "Zone ID from /locations/zones."
          },
          "area": {
            "type": "string",
            "nullable": true,
            "description": "Area ID from /locations/areas (optional)."
          },
          "cityName": {
            "type": "string",
            "nullable": true,
            "description": "Name of the city (for record-keeping). Optional, as it can be looked up from the city ID, but providing it can be a useful fallback."
          },
          "zoneName": {
            "type": "string",
            "nullable": true,
            "description": "Name of the zone (for record-keeping). Optional, can be looked up from zone ID."
          },
          "areaName": {
            "type": "string",
            "nullable": true,
            "description": "Name of the area (for record-keeping). Optional, can be looked up from area ID."
          },
          "notes": {
            "type": "string",
            "maxLength": 500,
            "nullable": true
          },
          "items": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": [
                "productId",
                "quantity",
                "price"
              ],
              "properties": {
                "productId": {
                  "type": "string"
                },
                "variantId": {
                  "type": "string",
                  "nullable": true
                },
                "quantity": {
                  "type": "integer",
                  "minimum": 1
                },
                "price": {
                  "type": "number",
                  "minimum": 0,
                  "description": "The final price per unit for this item, after any product-level discounts but before order-level discounts."
                }
              }
            }
          },
          "discountAmount": {
            "type": "number",
            "minimum": 0,
            "nullable": true,
            "description": "The total amount of discount applied to the order."
          },
          "discountCode": {
            "type": "string",
            "nullable": true,
            "description": "The discount code used, if any. This is used for logging usage."
          },
          "shippingCharge": {
            "type": "number",
            "minimum": 0
          },
          "totalAmount": {
            "type": "number",
            "nullable": true,
            "description": "The final total amount of the order. If not provided, it will be calculated on the server as: (items total) + shippingCharge - discountAmount."
          }
        }
      }
    }
  },
  "tags": [
    {
      "name": "Auth",
      "description": "Authentication and authorization."
    },
    {
      "name": "System",
      "description": "Endpoints for system health and status."
    },
    {
      "name": "Products",
      "description": "Endpoints for retrieving product information."
    },
    {
      "name": "Categories",
      "description": "Endpoints for product categories."
    },
    {
      "name": "Collections",
      "description": "Endpoints for managing homepage content collections."
    },
    {
      "name": "Attributes",
      "description": "Endpoints for retrieving filterable product attributes."
    },
    {
      "name": "Search",
      "description": "Endpoints for site-wide search."
    },
    {
      "name": "Orders",
      "description": "Endpoints for creating and managing orders."
    },
    {
      "name": "Shipping Methods",
      "description": "Endpoints for retrieving available shipping options and fees."
    },
    {
      "name": "Locations",
      "description": "Endpoints for delivery locations (cities, zones, areas)."
    },
    {
      "name": "Discounts",
      "description": "Endpoints for validating and applying discounts."
    },
    {
      "name": "Storefront Content",
      "description": "Endpoints for retrieving general storefront content like navigations, footers, etc."
    },
    {
      "name": "Hero",
      "description": "Endpoints for managing homepage hero sections."
    },
    {
      "name": "Header",
      "description": "Endpoints for retrieving header configuration."
    },
    {
      "name": "Footer",
      "description": "Endpoints for retrieving footer configuration."
    },
    {
      "name": "Navigation",
      "description": "Endpoints for retrieving navigation menus."
    },
    {
      "name": "Pages",
      "description": "Endpoints for retrieving CMS pages."
    },
    {
      "name": "Widgets",
      "description": "Endpoints for dynamic, user-generated content widgets."
    },
    {
      "name": "Checkout Languages",
      "description": "Endpoints for checkout page localization."
    },
    {
      "name": "SEO",
      "description": "Endpoints for global SEO configuration."
    },
    {
      "name": "Analytics",
      "description": "Endpoints for third-party analytics configurations."
    },
    {
      "name": "Meta Conversions API",
      "description": "Endpoints for server-side event tracking with Meta."
    },
    {
      "name": "Cache Management",
      "description": "Endpoints for managing the API cache."
    }
  ],
  "paths": {
    "/auth/token": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Obtain a JWT for API access",
        "description": "This endpoint is for machine-to-machine authentication. A client service must provide a pre-configured static API token in the `X-API-Token` header. In return, it receives a short-lived JSON Web Token (JWT) which must be used as a Bearer token for all subsequent requests to protected endpoints.",
        "security": [
          {
            "apiToken": []
          }
        ],
        "parameters": [
          {
            "name": "X-API-Token",
            "in": "header",
            "description": "The static, pre-shared API token for your service.",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully generated and returned a JWT.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "token": {
                          "type": "string",
                          "description": "The JWT to be used for authenticating subsequent requests.",
                          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. The provided `X-API-Token` was missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/auth/me": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get current user information",
        "description": "Returns information about the service or user associated with the provided JWT. This is useful for verifying that a token is valid and checking the identity of the authenticated party.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved identity information.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "user": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string",
                              "example": "system"
                            },
                            "email": {
                              "type": "string",
                              "example": "system@scalius.com"
                            },
                            "name": {
                              "type": "string",
                              "example": "System Service"
                            },
                            "role": {
                              "type": "string",
                              "example": "system"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. The provided JWT was missing, invalid, or expired.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/auth/revoke": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "Revoke the current JWT",
        "description": "Invalidates the currently used JWT by adding it to a server-side blacklist. The token will no longer be accepted for authentication, even if it has not yet expired. This is useful for logout functionality.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully revoked the token.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Token revoked successfully"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/auth/token-stats": {
      "get": {
        "tags": [
          "Auth"
        ],
        "summary": "Get token statistics (Admin Only)",
        "description": "Returns internal statistics about the JWT system, such as the number of currently blacklisted tokens. This endpoint is restricted to users with the 'admin' or 'system' role.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Token system statistics.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "blacklistedTokensCount": {
                          "type": "integer",
                          "example": 0
                        },
                        "jwtSecret": {
                          "type": "string",
                          "description": "A partially redacted view of the JWT secret.",
                          "example": "you...ion"
                        },
                        "isUsingDefaultSecret": {
                          "type": "boolean",
                          "description": "Indicates if the insecure default secret is being used.",
                          "example": false
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "403": {
            "description": "Forbidden. The authenticated user does not have sufficient permissions.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/products": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "List all products with filtering",
        "description": "Returns a paginated list of products. This endpoint supports advanced filtering by category, price range, and dynamic product attributes, as well as searching and sorting. It's the primary endpoint for building product listing pages (PLP) or shop pages.",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Page number for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Number of products per page.",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 20,
              "minimum": 1,
              "maximum": 100
            }
          },
          {
            "name": "category",
            "in": "query",
            "description": "Filter by a specific category ID.",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "search",
            "in": "query",
            "description": "Search term to filter products by name.",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "Sort order for the products.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "newest",
                "price-asc",
                "price-desc",
                "name-asc",
                "name-desc",
                "discount"
              ],
              "default": "newest"
            }
          },
          {
            "name": "minPrice",
            "in": "query",
            "description": "Filter by a minimum price.",
            "required": false,
            "schema": {
              "type": "number",
              "minimum": 0
            }
          },
          {
            "name": "maxPrice",
            "in": "query",
            "description": "Filter by a maximum price.",
            "required": false,
            "schema": {
              "type": "number",
              "minimum": 0
            }
          },
          {
            "name": "freeDelivery",
            "in": "query",
            "description": "Filter for products that have free delivery.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ]
            }
          },
          {
            "name": "hasDiscount",
            "in": "query",
            "description": "Filter for products that have a discount.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ]
            }
          },
          {
            "name": "ids",
            "in": "query",
            "description": "Fetch a specific set of products by their comma-separated IDs.",
            "required": false,
            "schema": {
              "type": "string",
              "example": "prod_123,prod_456,prod_789"
            }
          },
          {
            "name": "[attribute_slug]",
            "in": "query",
            "description": "Dynamically filter by any attribute slug (e.g., `brand=Samsung`, `warranty=2-year`). Obtain available attribute slugs from the `/attributes/filterable` endpoint. Multiple attribute filters can be combined.",
            "required": false,
            "style": "form",
            "explode": true,
            "schema": {
              "type": "string"
            },
            "example": "brand=Samsung&color=Black"
          }
        ],
        "responses": {
          "200": {
            "description": "A paginated list of products.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "products": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "prod_20b5u8VDOcSnP8x_0pjSt"
                          },
                          "name": {
                            "type": "string",
                            "example": "Samsung Galaxy S23"
                          },
                          "price": {
                            "type": "number",
                            "example": 50000
                          },
                          "slug": {
                            "type": "string",
                            "example": "samsung-galaxy-s23"
                          },
                          "discountType": {
                            "type": "string",
                            "enum": [
                              "percentage",
                              "flat"
                            ],
                            "example": "percentage",
                            "description": "Type of discount applied to the product"
                          },
                          "discountPercentage": {
                            "type": "number",
                            "nullable": true,
                            "example": 10,
                            "description": "Discount percentage (0-100) when discountType is 'percentage'"
                          },
                          "discountAmount": {
                            "type": "number",
                            "nullable": true,
                            "example": 5000,
                            "description": "Flat discount amount when discountType is 'flat'"
                          },
                          "freeDelivery": {
                            "type": "boolean",
                            "example": false
                          },
                          "categoryId": {
                            "type": "string",
                            "example": "cat_T07m1YNkrTiBuAuAx-nUb"
                          },
                          "imageUrl": {
                            "type": "string",
                            "nullable": true,
                            "description": "URL of the product's primary image.",
                            "example": "https://cdn.scalius.com/galaxy-s23.png"
                          },
                          "category": {
                            "type": "object",
                            "nullable": true,
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "cat_T07m1YNkrTiBuAuAx-nUb"
                              },
                              "name": {
                                "type": "string",
                                "example": "SmartPhones"
                              },
                              "slug": {
                                "type": "string",
                                "example": "smartphones"
                              }
                            }
                          },
                          "discountedPrice": {
                            "type": "number",
                            "description": "The price after the discount percentage has been applied. Equal to `price` if no discount.",
                            "example": 45000
                          },
                          "hasVariants": {
                            "type": "boolean",
                            "description": "Indicates if the product has multiple variants (e.g., by size or color).",
                            "example": true
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    },
                    "pagination": {
                      "type": "object",
                      "properties": {
                        "page": {
                          "type": "integer",
                          "example": 1
                        },
                        "limit": {
                          "type": "integer",
                          "example": 20
                        },
                        "total": {
                          "type": "integer",
                          "example": 25
                        },
                        "totalPages": {
                          "type": "integer",
                          "example": 2
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch products",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/products/{slug}": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Get a single product by slug",
        "description": "Returns detailed information for a specific product, including all its images, variants, attributes, rich content sections, and related products. This is the primary endpoint for building a product detail page (PDP).",
        "parameters": [
          {
            "name": "slug",
            "in": "path",
            "required": true,
            "description": "The URL-friendly slug of the product to retrieve.",
            "schema": {
              "type": "string",
              "example": "amazfit-bip-5"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Detailed information for the requested product.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "product": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                        },
                        "name": {
                          "type": "string",
                          "example": "Amazfit Bip 5 Unity Bluetooth Calling Smart Watch"
                        },
                        "description": {
                          "type": "string",
                          "nullable": true,
                          "description": "The main HTML description of the product.",
                          "example": "<h1>⌚ <strong>Amazfit Bip 5 Unity – Bluetooth Calling Smart Watch</strong></h1>"
                        },
                        "price": {
                          "type": "number",
                          "example": 5600
                        },
                        "categoryId": {
                          "type": "string",
                          "example": "cat_fj1ZspPwVuHyQVCGDC0jf"
                        },
                        "slug": {
                          "type": "string",
                          "example": "amazfit-bip-5"
                        },
                        "metaTitle": {
                          "type": "string",
                          "nullable": true,
                          "example": "Amazfit Bip 5 Unity – Bluetooth Calling Smartwatch"
                        },
                        "metaDescription": {
                          "type": "string",
                          "nullable": true,
                          "example": "Amazfit Bip 5 Unity: Bluetooth calling, 1.91\" HD display, 100+ sports modes & 11-day battery."
                        },
                        "discountType": {
                          "type": "string",
                          "enum": [
                            "percentage",
                            "flat"
                          ],
                          "example": "percentage",
                          "description": "Type of discount applied to the product"
                        },
                        "discountPercentage": {
                          "type": "number",
                          "nullable": true,
                          "example": 7,
                          "description": "Discount percentage (0-100) when discountType is 'percentage'"
                        },
                        "discountAmount": {
                          "type": "number",
                          "nullable": true,
                          "example": 0,
                          "description": "Flat discount amount when discountType is 'flat'"
                        },
                        "freeDelivery": {
                          "type": "boolean",
                          "example": false
                        },
                        "isActive": {
                          "type": "boolean",
                          "example": true
                        },
                        "features": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "A list of key features extracted from the product description.",
                          "example": [
                            "Bluetooth Calling",
                            "1.91\" HD Display",
                            "11-Day Battery Life"
                          ]
                        },
                        "discountedPrice": {
                          "type": "number",
                          "example": 5208
                        },
                        "hasVariants": {
                          "type": "boolean",
                          "description": "Indicates if the product has multiple variants (e.g., by size or color).",
                          "example": true
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-06-02T15:27:31.000Z"
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-06-30T18:10:28.000Z"
                        },
                        "deletedAt": {
                          "type": "string",
                          "nullable": true,
                          "format": "date-time",
                          "example": null
                        },
                        "attributes": {
                          "type": "array",
                          "description": "A list of filterable attributes assigned to the product.",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "example": "Brand"
                              },
                              "value": {
                                "type": "string",
                                "example": "Amazfit"
                              },
                              "slug": {
                                "type": "string",
                                "example": "brand"
                              }
                            }
                          }
                        },
                        "additionalInfo": {
                          "type": "array",
                          "description": "Rich content sections for the product, often used for detailed specifications or feature callouts.",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "prc_123xyz"
                              },
                              "title": {
                                "type": "string",
                                "example": "Technical Specifications"
                              },
                              "content": {
                                "type": "string",
                                "example": "<ul><li>Display: 1.91 inch TFT</li><li>Resolution: 320x380</li><li>Water Resistance: IP68</li></ul>"
                              }
                            }
                          }
                        }
                      }
                    },
                    "category": {
                      "type": "object",
                      "nullable": true,
                      "description": "The category the product belongs to.",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "cat_fj1ZspPwVuHyQVCGDC0jf"
                        },
                        "name": {
                          "type": "string",
                          "example": "Tech Gadgets"
                        },
                        "slug": {
                          "type": "string",
                          "example": "tech-gadgets"
                        },
                        "description": {
                          "type": "string",
                          "nullable": true
                        },
                        "imageUrl": {
                          "type": "string",
                          "nullable": true
                        },
                        "metaTitle": {
                          "type": "string",
                          "nullable": true
                        },
                        "metaDescription": {
                          "type": "string",
                          "nullable": true
                        }
                      }
                    },
                    "images": {
                      "type": "array",
                      "description": "A list of all images for the product, sorted by `sortOrder`.",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "img_h1qzC6HRQtAHbuzkhS_px"
                          },
                          "productId": {
                            "type": "string",
                            "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                          },
                          "url": {
                            "type": "string",
                            "example": "https://cdn.scalius.com/Nur_AVLkaIoEeFCRphKhq.png"
                          },
                          "alt": {
                            "type": "string",
                            "example": "Amazfit Bip 5 Unity side view"
                          },
                          "isPrimary": {
                            "type": "boolean",
                            "example": true
                          },
                          "sortOrder": {
                            "type": "integer",
                            "example": 0
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    },
                    "variants": {
                      "type": "array",
                      "description": "A list of all available variants for the product (e.g., by color, size).",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "var_2bPev_-ZazMfirwpAu9Cz"
                          },
                          "productId": {
                            "type": "string",
                            "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                          },
                          "size": {
                            "type": "string",
                            "nullable": true,
                            "example": null
                          },
                          "color": {
                            "type": "string",
                            "nullable": true,
                            "example": "White"
                          },
                          "weight": {
                            "type": "number",
                            "nullable": true,
                            "example": 170
                          },
                          "sku": {
                            "type": "string",
                            "nullable": true,
                            "example": "bip-5w"
                          },
                          "price": {
                            "type": "number",
                            "description": "The specific price for this variant. If null, it inherits the parent product's price.",
                            "nullable": true,
                            "example": 5600
                          },
                          "stock": {
                            "type": "integer",
                            "example": 11
                          },
                          "discountType": {
                            "type": "string",
                            "enum": [
                              "percentage",
                              "flat"
                            ],
                            "example": "percentage",
                            "description": "Type of discount applied to this variant"
                          },
                          "discountPercentage": {
                            "type": "number",
                            "nullable": true,
                            "example": 0,
                            "description": "Discount percentage for this variant"
                          },
                          "discountAmount": {
                            "type": "number",
                            "nullable": true,
                            "example": 0,
                            "description": "Flat discount amount for this variant"
                          },
                          "colorSortOrder": {
                            "type": "integer",
                            "example": 0,
                            "description": "Sort order for color-based grouping (used for variant image mapping)"
                          },
                          "sizeSortOrder": {
                            "type": "integer",
                            "example": 0,
                            "description": "Sort order for size-based grouping (used for storefront display)"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "deletedAt": {
                            "type": "string",
                            "nullable": true,
                            "format": "date-time"
                          }
                        }
                      }
                    },
                    "relatedProducts": {
                      "type": "array",
                      "description": "A list of related products, typically from the same category.",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "prod_asV5RrtG4seFCrBJgwXbY"
                          },
                          "name": {
                            "type": "string",
                            "example": "Meko Ti5 ANC+LCD True Wireless Earbuds"
                          },
                          "price": {
                            "type": "number",
                            "example": 2200
                          },
                          "slug": {
                            "type": "string",
                            "example": "meko-ti5-anc-lcd-true-wireless-earbuds"
                          },
                          "discountType": {
                            "type": "string",
                            "enum": [
                              "percentage",
                              "flat"
                            ],
                            "example": "percentage"
                          },
                          "discountPercentage": {
                            "type": "number",
                            "nullable": true,
                            "example": null
                          },
                          "discountAmount": {
                            "type": "number",
                            "nullable": true,
                            "example": null
                          },
                          "freeDelivery": {
                            "type": "boolean",
                            "nullable": true,
                            "example": true
                          },
                          "imageUrl": {
                            "type": "string",
                            "nullable": true,
                            "example": "https://cdn.scalius.com/9UiALYviYt69DdLiGSJ7t.png"
                          },
                          "discountedPrice": {
                            "type": "number",
                            "example": 2200
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Product not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch product",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/products/{productId}/variants": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Get all variants for a product",
        "description": "Returns a simple list of all variants for a specific product ID.",
        "parameters": [
          {
            "name": "productId",
            "in": "path",
            "required": true,
            "description": "ID of the product to get variants for.",
            "schema": {
              "type": "string",
              "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A list of product variants.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "variants": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "var_2bPev_-ZazMfirwpAu9Cz"
                          },
                          "productId": {
                            "type": "string",
                            "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                          },
                          "size": {
                            "type": "string",
                            "nullable": true,
                            "example": null
                          },
                          "color": {
                            "type": "string",
                            "nullable": true,
                            "example": "White"
                          },
                          "weight": {
                            "type": "number",
                            "nullable": true,
                            "example": 170
                          },
                          "sku": {
                            "type": "string",
                            "nullable": true,
                            "example": "bip-5w"
                          },
                          "price": {
                            "type": "number",
                            "nullable": true,
                            "example": 5600
                          },
                          "stock": {
                            "type": "integer",
                            "example": 11
                          },
                          "colorSortOrder": {
                            "type": "integer",
                            "example": 0,
                            "description": "Sort order for color-based grouping"
                          },
                          "sizeSortOrder": {
                            "type": "integer",
                            "example": 0,
                            "description": "Sort order for size-based grouping"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch product variants",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/products/search": {
      "get": {
        "tags": [
          "Products"
        ],
        "summary": "Search products for admin forms",
        "description": "A simplified product search endpoint, optimized for use in admin panels, like adding a product to an order form. Returns products with their variants.",
        "parameters": [
          {
            "name": "search",
            "in": "query",
            "description": "Search term to find products by name.",
            "required": false,
            "schema": {
              "type": "string",
              "default": ""
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Number of products per page.",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": 1,
              "maximum": 100
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully searched products.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                          },
                          "name": {
                            "type": "string",
                            "example": "Amazfit Bip 5 Unity Bluetooth Calling Smart Watch"
                          },
                          "price": {
                            "type": "number",
                            "example": 5600
                          },
                          "discountType": {
                            "type": "string",
                            "enum": [
                              "percentage",
                              "flat"
                            ],
                            "example": "percentage"
                          },
                          "discountPercentage": {
                            "type": "number",
                            "nullable": true,
                            "example": 7
                          },
                          "discountAmount": {
                            "type": "number",
                            "nullable": true,
                            "example": 0
                          },
                          "primaryImageUrl": {
                            "type": "string",
                            "nullable": true,
                            "example": "https://cdn.scalius.com/Nur_AVLkaIoEeFCRphKhq.png"
                          },
                          "variants": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "string",
                                  "example": "var_2bPev_-ZazMfirwpAu9Cz"
                                },
                                "productId": {
                                  "type": "string",
                                  "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                                },
                                "size": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "color": {
                                  "type": "string",
                                  "nullable": true,
                                  "example": "White"
                                },
                                "weight": {
                                  "type": "number",
                                  "nullable": true
                                },
                                "sku": {
                                  "type": "string",
                                  "nullable": true,
                                  "example": "bip-5w"
                                },
                                "price": {
                                  "type": "number",
                                  "nullable": true,
                                  "example": 5600
                                },
                                "stock": {
                                  "type": "integer",
                                  "example": 11
                                },
                                "discountType": {
                                  "type": "string",
                                  "enum": [
                                    "percentage",
                                    "flat"
                                  ],
                                  "example": "percentage"
                                },
                                "discountPercentage": {
                                  "type": "number",
                                  "nullable": true,
                                  "example": 0
                                },
                                "discountAmount": {
                                  "type": "number",
                                  "nullable": true,
                                  "example": 0
                                },
                                "colorSortOrder": {
                                  "type": "integer",
                                  "example": 0,
                                  "description": "Sort order for color-based grouping"
                                },
                                "sizeSortOrder": {
                                  "type": "integer",
                                  "example": 0,
                                  "description": "Sort order for size-based grouping"
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "pagination": {
                      "type": "object",
                      "properties": {
                        "page": {
                          "type": "integer",
                          "example": 1
                        },
                        "limit": {
                          "type": "integer",
                          "example": 10
                        },
                        "total": {
                          "type": "integer",
                          "example": 25
                        },
                        "totalPages": {
                          "type": "integer",
                          "example": 3
                        },
                        "hasNextPage": {
                          "type": "boolean",
                          "example": true
                        },
                        "hasPrevPage": {
                          "type": "boolean",
                          "example": false
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid query parameters",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to search products",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/categories": {
      "get": {
        "tags": [
          "Categories"
        ],
        "summary": "List all categories",
        "description": "Returns a list of all categories",
        "responses": {
          "200": {
            "description": "Successfully retrieved categories",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "categories": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "cat_fj1ZspPwVuHyQVCGDC0jf"
                          },
                          "name": {
                            "type": "string",
                            "example": "Tech Gadgets"
                          },
                          "slug": {
                            "type": "string",
                            "example": "tech-gadgets"
                          },
                          "description": {
                            "type": "string",
                            "example": "🔌 From smart tools to must-have devices — tech that simplifies & empowers everyday life."
                          },
                          "imageUrl": {
                            "type": "string",
                            "nullable": true,
                            "example": null
                          },
                          "createdAt": {
                            "type": "string",
                            "example": "+057378-04-03T14:00:00.000Z"
                          },
                          "metaTitle": {
                            "type": "string",
                            "nullable": true,
                            "example": "Cool Tech Gadgets Online – Smart Tools"
                          },
                          "metaDescription": {
                            "type": "string",
                            "nullable": true,
                            "example": "Shop trending tech gadgets that make life easier & smarter. Functional, innovative & cool."
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/categories/{slug}": {
      "get": {
        "tags": [
          "Categories"
        ],
        "summary": "Get category by slug",
        "description": "Returns detailed information about a specific category",
        "parameters": [
          {
            "name": "slug",
            "in": "path",
            "required": true,
            "description": "Slug of the category to retrieve",
            "schema": {
              "type": "string",
              "example": "tech-gadgets"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved category",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "category": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "cat_fj1ZspPwVuHyQVCGDC0jf"
                        },
                        "name": {
                          "type": "string",
                          "example": "Tech Gadgets"
                        },
                        "slug": {
                          "type": "string",
                          "example": "tech-gadgets"
                        },
                        "description": {
                          "type": "string",
                          "example": "🔌 From smart tools to must-have devices — tech that simplifies & empowers everyday life."
                        },
                        "imageUrl": {
                          "type": "string",
                          "nullable": true,
                          "example": null
                        },
                        "createdAt": {
                          "type": "string",
                          "example": "+057378-04-03T14:00:00.000Z"
                        },
                        "metaTitle": {
                          "type": "string",
                          "nullable": true,
                          "example": "Cool Tech Gadgets Online – Smart Tools"
                        },
                        "metaDescription": {
                          "type": "string",
                          "nullable": true,
                          "example": "Shop trending tech gadgets that make life easier & smarter. Functional, innovative & cool."
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Category not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/categories/{slug}/products": {
      "get": {
        "tags": [
          "Categories"
        ],
        "summary": "Get products in a category with filtering",
        "description": "Returns paginated products in a category with support for attribute filtering, search, price range, and sorting. Supports dynamic attribute filtering by passing attribute slugs as query parameters.",
        "parameters": [
          {
            "name": "slug",
            "in": "path",
            "required": true,
            "description": "Slug of the category",
            "schema": {
              "type": "string",
              "example": "smartphones"
            }
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "description": "Page number for pagination",
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "description": "Number of products per page",
            "schema": {
              "type": "integer",
              "default": 20,
              "minimum": 1,
              "maximum": 100
            }
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "description": "Sort order for products",
            "schema": {
              "type": "string",
              "enum": [
                "newest",
                "price-asc",
                "price-desc",
                "name-asc",
                "name-desc",
                "discount"
              ],
              "default": "newest"
            }
          },
          {
            "name": "search",
            "in": "query",
            "required": false,
            "description": "Search term to filter products by name",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "minPrice",
            "in": "query",
            "required": false,
            "description": "Minimum price filter",
            "schema": {
              "type": "number",
              "minimum": 0
            }
          },
          {
            "name": "maxPrice",
            "in": "query",
            "required": false,
            "description": "Maximum price filter",
            "schema": {
              "type": "number",
              "minimum": 0
            }
          },
          {
            "name": "freeDelivery",
            "in": "query",
            "required": false,
            "description": "Filter by free delivery availability",
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ]
            }
          },
          {
            "name": "hasDiscount",
            "in": "query",
            "required": false,
            "description": "Filter by discount availability",
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ]
            }
          },
          {
            "name": "samsung",
            "in": "query",
            "required": false,
            "description": "Example: Filter by Samsung attribute value (dynamic attribute filtering)",
            "schema": {
              "type": "string",
              "example": "S Series"
            }
          },
          {
            "name": "warranty",
            "in": "query",
            "required": false,
            "description": "Example: Filter by warranty attribute value (dynamic attribute filtering)",
            "schema": {
              "type": "string",
              "example": "2 Year"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved category products",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "category": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "slug": {
                          "type": "string"
                        },
                        "description": {
                          "type": "string"
                        },
                        "imageUrl": {
                          "type": "string",
                          "nullable": true
                        },
                        "metaTitle": {
                          "type": "string",
                          "nullable": true
                        },
                        "metaDescription": {
                          "type": "string",
                          "nullable": true
                        }
                      }
                    },
                    "products": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "price": {
                            "type": "number"
                          },
                          "slug": {
                            "type": "string"
                          },
                          "discountPercentage": {
                            "type": "number",
                            "nullable": true
                          },
                          "freeDelivery": {
                            "type": "boolean"
                          },
                          "imageUrl": {
                            "type": "string",
                            "nullable": true
                          },
                          "discountedPrice": {
                            "type": "number"
                          },
                          "createdAt": {
                            "type": "string",
                            "nullable": true
                          },
                          "updatedAt": {
                            "type": "string",
                            "nullable": true
                          },
                          "category": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              },
                              "slug": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    },
                    "pagination": {
                      "type": "object",
                      "properties": {
                        "page": {
                          "type": "integer"
                        },
                        "limit": {
                          "type": "integer"
                        },
                        "total": {
                          "type": "integer"
                        },
                        "totalPages": {
                          "type": "integer"
                        }
                      }
                    },
                    "appliedFilters": {
                      "type": "object",
                      "properties": {
                        "attributes": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "slug": {
                                "type": "string"
                              },
                              "value": {
                                "type": "string"
                              }
                            }
                          }
                        },
                        "search": {
                          "type": "string",
                          "nullable": true
                        },
                        "minPrice": {
                          "type": "number",
                          "nullable": true
                        },
                        "maxPrice": {
                          "type": "number",
                          "nullable": true
                        },
                        "freeDelivery": {
                          "type": "string",
                          "nullable": true
                        },
                        "hasDiscount": {
                          "type": "string",
                          "nullable": true
                        },
                        "sort": {
                          "type": "string"
                        }
                      }
                    }
                  },
                  "example": {
                    "category": {
                      "id": "cat_123",
                      "name": "Smartphones",
                      "slug": "smartphones",
                      "description": "Latest smartphones and mobile devices"
                    },
                    "products": [
                      {
                        "id": "prod_456",
                        "name": "Samsung Galaxy S23",
                        "price": 50000,
                        "slug": "samsung-galaxy-s23",
                        "discountPercentage": 10,
                        "freeDelivery": true,
                        "imageUrl": "https://example.com/image.jpg",
                        "discountedPrice": 45000
                      }
                    ],
                    "pagination": {
                      "page": 1,
                      "limit": 20,
                      "total": 1,
                      "totalPages": 1
                    },
                    "appliedFilters": {
                      "attributes": [
                        {
                          "slug": "samsung",
                          "value": "S Series"
                        },
                        {
                          "slug": "warranty",
                          "value": "2 Year"
                        }
                      ],
                      "search": null,
                      "minPrice": null,
                      "maxPrice": null,
                      "freeDelivery": null,
                      "hasDiscount": null,
                      "sort": "newest"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Category not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/collections": {
      "get": {
        "tags": [
          "Collections"
        ],
        "summary": "List all active collections",
        "description": "Returns a list of all active collections with their configuration. This endpoint is used to fetch the structure of homepage sections, like product carousels or grids. Collections now support multiple categories and flexible product selection.",
        "responses": {
          "200": {
            "description": "Successfully retrieved collections",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "collections": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "coll_-8Q6s6Fq0X0zDWs6hn8Hn"
                          },
                          "name": {
                            "type": "string",
                            "example": "Homepage Featured"
                          },
                          "type": {
                            "type": "string",
                            "enum": [
                              "collection1",
                              "collection2"
                            ],
                            "description": "UI rendering style only. collection1 = grid with featured product, collection2 = horizontal scroll",
                            "example": "collection1"
                          },
                          "config": {
                            "type": "object",
                            "description": "JSON object defining the collection's behavior and product selection",
                            "properties": {
                              "categoryIds": {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                },
                                "description": "Array of category IDs to pull products from",
                                "example": [
                                  "cat_123",
                                  "cat_456"
                                ]
                              },
                              "productIds": {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                },
                                "description": "Array of specific product IDs to include",
                                "example": [
                                  "prod_abc",
                                  "prod_xyz"
                                ]
                              },
                              "featuredProductId": {
                                "type": "string",
                                "nullable": true,
                                "description": "Optional featured product for collection1 style",
                                "example": "prod_featured"
                              },
                              "maxProducts": {
                                "type": "number",
                                "description": "Maximum number of products to display (1-24)",
                                "example": 8
                              },
                              "title": {
                                "type": "string",
                                "nullable": true,
                                "description": "Custom display title",
                                "example": "Summer Collection"
                              },
                              "subtitle": {
                                "type": "string",
                                "nullable": true,
                                "description": "Custom display subtitle",
                                "example": "Hot deals for the season"
                              }
                            }
                          },
                          "sortOrder": {
                            "type": "integer",
                            "example": 1
                          },
                          "isActive": {
                            "type": "boolean",
                            "example": true
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "example": "2025-12-24T18:05:18.000Z"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "example": "2025-12-24T18:05:18.000Z"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/collections/{id}": {
      "get": {
        "tags": [
          "Collections"
        ],
        "summary": "Get collection by ID",
        "description": "Returns detailed information about a specific collection by its ID, including associated categories (array) and products. Collections can now pull from multiple categories and/or specific products.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "ID of the collection to retrieve.",
            "schema": {
              "type": "string",
              "example": "coll_-8Q6s6Fq0X0zDWs6hn8Hn"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved collection",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "collection": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "coll_-8Q6s6Fq0X0zDWs6hn8Hn"
                        },
                        "name": {
                          "type": "string",
                          "example": "Homepage Featured"
                        },
                        "type": {
                          "type": "string",
                          "enum": [
                            "collection1",
                            "collection2"
                          ],
                          "description": "UI rendering style only",
                          "example": "collection1"
                        },
                        "config": {
                          "type": "object",
                          "properties": {
                            "categoryIds": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              },
                              "description": "Category IDs this collection pulls from",
                              "example": [
                                "cat_123",
                                "cat_456"
                              ]
                            },
                            "productIds": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              },
                              "description": "Specific product IDs included",
                              "example": [
                                "prod_abc"
                              ]
                            },
                            "featuredProductId": {
                              "type": "string",
                              "nullable": true,
                              "example": "prod_featured"
                            },
                            "maxProducts": {
                              "type": "number",
                              "example": 8
                            },
                            "title": {
                              "type": "string",
                              "nullable": true,
                              "example": "Summer Sale"
                            },
                            "subtitle": {
                              "type": "string",
                              "nullable": true,
                              "example": "Best deals of the season"
                            }
                          }
                        },
                        "sortOrder": {
                          "type": "integer",
                          "example": 1
                        },
                        "isActive": {
                          "type": "boolean",
                          "example": true
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-12-24T18:05:18.000Z"
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time",
                          "example": "2025-12-24T18:05:18.000Z"
                        },
                        "deletedAt": {
                          "type": "string",
                          "nullable": true,
                          "format": "date-time",
                          "example": null
                        },
                        "categories": {
                          "type": "array",
                          "description": "CHANGED: Now an array of category objects (was single 'category' object)",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "cat_123"
                              },
                              "name": {
                                "type": "string",
                                "example": "Tech Gadgets"
                              },
                              "slug": {
                                "type": "string",
                                "example": "tech-gadgets"
                              }
                            }
                          },
                          "example": [
                            {
                              "id": "cat_123",
                              "name": "Tech Gadgets",
                              "slug": "tech-gadgets"
                            },
                            {
                              "id": "cat_456",
                              "name": "Smart Watches",
                              "slug": "smart-watches"
                            }
                          ]
                        },
                        "products": {
                          "type": "array",
                          "description": "Products in this collection (from categories and/or specific products)",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                              },
                              "name": {
                                "type": "string",
                                "example": "Amazfit Bip 5 Unity Bluetooth Calling Smart Watch"
                              },
                              "price": {
                                "type": "number",
                                "example": 5600
                              },
                              "slug": {
                                "type": "string",
                                "example": "amazfit-bip-5"
                              },
                              "discountPercentage": {
                                "type": "number",
                                "nullable": true,
                                "example": 7
                              },
                              "imageUrl": {
                                "type": "string",
                                "nullable": true,
                                "example": "https://cdn.scalius.com/Nur_AVLkaIoEeFCRphKhq.png"
                              },
                              "discountedPrice": {
                                "type": "number",
                                "example": 5208
                              }
                            }
                          }
                        },
                        "featuredProduct": {
                          "type": "object",
                          "nullable": true,
                          "description": "Featured product for collection1 style (optional)",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "name": {
                              "type": "string"
                            },
                            "price": {
                              "type": "number"
                            },
                            "discountPercentage": {
                              "type": "number",
                              "nullable": true
                            },
                            "slug": {
                              "type": "string"
                            },
                            "imageUrl": {
                              "type": "string",
                              "nullable": true
                            },
                            "discountedPrice": {
                              "type": "number"
                            }
                          },
                          "example": {
                            "id": "prod_featured",
                            "name": "Featured Smartwatch",
                            "price": 9999,
                            "discountPercentage": 10,
                            "slug": "featured-smartwatch",
                            "imageUrl": "https://cdn.scalius.com/featured.png",
                            "discountedPrice": 8999
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Collection not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/orders": {
      "get": {
        "tags": [
          "Orders"
        ],
        "summary": "List all orders",
        "description": "Returns a paginated list of orders. Supports filtering by status and searching by order ID, customer name, or phone number. Essential for the main order management view in an admin panel.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "Page number for pagination.",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 1,
              "minimum": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Number of orders per page.",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10,
              "minimum": 1,
              "maximum": 100
            }
          },
          {
            "name": "status",
            "in": "query",
            "description": "Filter orders by a specific status.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "pending",
                "processing",
                "confirmed",
                "shipped",
                "delivered",
                "cancelled",
                "returned"
              ]
            }
          },
          {
            "name": "search",
            "in": "query",
            "description": "Search query for order ID, customer name, or customer phone.",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "The field to sort the orders by.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "customerName",
                "totalAmount",
                "status",
                "createdAt",
                "updatedAt"
              ],
              "default": "updatedAt"
            }
          },
          {
            "name": "order",
            "in": "query",
            "description": "The sort direction.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ],
              "default": "desc"
            }
          },
          {
            "name": "trashed",
            "in": "query",
            "description": "Set to 'true' to list soft-deleted orders instead of active ones.",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A paginated list of orders.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "orders": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "P10GRL"
                          },
                          "customerName": {
                            "type": "string",
                            "example": "John Doe"
                          },
                          "customerPhone": {
                            "type": "string",
                            "example": "01774452222"
                          },
                          "customerEmail": {
                            "type": "string",
                            "nullable": true,
                            "example": "john@example.com"
                          },
                          "customerId": {
                            "type": "string",
                            "nullable": true,
                            "example": "cust_qpG6vaiupfBccwoEw1IYT"
                          },
                          "totalAmount": {
                            "type": "number",
                            "example": 5318
                          },
                          "shippingCharge": {
                            "type": "number",
                            "example": 110
                          },
                          "discountAmount": {
                            "type": "number",
                            "example": 0
                          },
                          "status": {
                            "type": "string",
                            "example": "pending"
                          },
                          "city": {
                            "type": "string",
                            "example": "d6smoije4odr7887z40zy2z8"
                          },
                          "zone": {
                            "type": "string",
                            "example": "uiljxeeki5idue50937a8aw2"
                          },
                          "area": {
                            "type": "string",
                            "nullable": true
                          },
                          "cityName": {
                            "type": "string",
                            "example": "Bagerhat"
                          },
                          "zoneName": {
                            "type": "string",
                            "example": "Bagerhat Sadar"
                          },
                          "areaName": {
                            "type": "string",
                            "nullable": true
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "itemCount": {
                            "type": "integer",
                            "description": "The number of unique line items in the order.",
                            "example": 1
                          },
                          "totalQuantity": {
                            "type": "integer",
                            "description": "The total number of all units in the order.",
                            "example": 1
                          }
                        }
                      }
                    },
                    "pagination": {
                      "type": "object",
                      "properties": {
                        "page": {
                          "type": "integer",
                          "example": 1
                        },
                        "limit": {
                          "type": "integer",
                          "example": 10
                        },
                        "total": {
                          "type": "integer",
                          "example": 1781
                        },
                        "totalPages": {
                          "type": "integer",
                          "example": 179
                        },
                        "hasNextPage": {
                          "type": "boolean",
                          "example": true
                        },
                        "hasPrevPage": {
                          "type": "boolean",
                          "example": false
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      },
      "post": {
        "tags": [
          "Orders"
        ],
        "summary": "Create a new order",
        "description": "Creates a new order, updates customer statistics, and decrements product stock. Upon successful creation, it also triggers a notification to admins. Note: `city`, `zone`, and `area` must be valid location IDs obtained from the `/locations` endpoints.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "customerName",
                  "customerPhone",
                  "shippingAddress",
                  "city",
                  "zone",
                  "items",
                  "shippingCharge"
                ],
                "properties": {
                  "customerName": {
                    "type": "string",
                    "minLength": 3,
                    "maxLength": 100,
                    "example": "Jane Doe"
                  },
                  "customerPhone": {
                    "type": "string",
                    "description": "Must be a valid Bangladeshi phone number.",
                    "pattern": "^(\\+88)?01[3-9]\\d{8}$",
                    "example": "01712345678"
                  },
                  "customerEmail": {
                    "type": "string",
                    "format": "email",
                    "nullable": true,
                    "example": "jane.doe@example.com"
                  },
                  "shippingAddress": {
                    "type": "string",
                    "minLength": 10,
                    "maxLength": 500,
                    "example": "123 Test Street, Test Block, Test City"
                  },
                  "city": {
                    "type": "string",
                    "description": "City ID from `/locations/cities`.",
                    "example": "d6smoije4odr7887z40zy2z8"
                  },
                  "zone": {
                    "type": "string",
                    "description": "Zone ID from `/locations/zones`.",
                    "example": "uiljxeeki5idue50937a8aw2"
                  },
                  "area": {
                    "type": "string",
                    "nullable": true,
                    "description": "Area ID from `/locations/areas` (optional)."
                  },
                  "cityName": {
                    "type": "string",
                    "description": "Name of the city (for display/record-keeping).",
                    "example": "Bagerhat"
                  },
                  "zoneName": {
                    "type": "string",
                    "description": "Name of the zone (for display/record-keeping).",
                    "example": "Bagerhat Sadar"
                  },
                  "areaName": {
                    "type": "string",
                    "nullable": true,
                    "description": "Name of the area (for display/record-keeping)."
                  },
                  "notes": {
                    "type": "string",
                    "maxLength": 500,
                    "nullable": true,
                    "example": "Please call before delivery."
                  },
                  "items": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "type": "object",
                      "required": [
                        "productId",
                        "quantity",
                        "price"
                      ],
                      "properties": {
                        "productId": {
                          "type": "string",
                          "example": "prod_KIY35Mdn1Bc8bsUq3fcn5"
                        },
                        "variantId": {
                          "type": "string",
                          "nullable": true,
                          "example": "var_vC_r149Ypu0FTKw1BsgxD"
                        },
                        "quantity": {
                          "type": "integer",
                          "minimum": 1,
                          "example": 1
                        },
                        "price": {
                          "type": "number",
                          "minimum": 0,
                          "description": "The final price per unit for this line item.",
                          "example": 5208
                        }
                      }
                    }
                  },
                  "discountAmount": {
                    "type": "number",
                    "minimum": 0,
                    "nullable": true,
                    "example": 100
                  },
                  "discountCode": {
                    "type": "string",
                    "nullable": true,
                    "description": "If a discount was applied, include its code to log usage.",
                    "example": "SUMMER10"
                  },
                  "shippingCharge": {
                    "type": "number",
                    "minimum": 0,
                    "example": 110
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Order created successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "The unique ID of the newly created order.",
                          "example": "T6UWMI"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Caused by either a validation error or insufficient stock.",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "type": "object",
                      "title": "Validation Error",
                      "properties": {
                        "success": {
                          "type": "boolean",
                          "example": false
                        },
                        "error": {
                          "type": "object",
                          "properties": {
                            "code": {
                              "type": "string",
                              "example": "VALIDATION_ERROR"
                            },
                            "message": {
                              "type": "string",
                              "example": "Invalid order data"
                            },
                            "details": {
                              "type": "array",
                              "items": {
                                "type": "object"
                              }
                            }
                          }
                        }
                      }
                    },
                    {
                      "type": "object",
                      "title": "Insufficient Stock Error",
                      "properties": {
                        "success": {
                          "type": "boolean",
                          "example": false
                        },
                        "error": {
                          "type": "object",
                          "properties": {
                            "code": {
                              "type": "string",
                              "example": "INSUFFICIENT_STOCK"
                            },
                            "message": {
                              "type": "string",
                              "example": "Insufficient stock for variant var_456"
                            },
                            "variantId": {
                              "type": "string",
                              "example": "var_456"
                            },
                            "available": {
                              "type": "integer",
                              "example": 3
                            },
                            "requested": {
                              "type": "integer",
                              "example": 5
                            }
                          }
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/orders/{id}": {
      "get": {
        "tags": [
          "Orders"
        ],
        "summary": "Get order details by ID",
        "description": "Returns all details for a specific order, including customer information, full item list (with product names and images), and any associated delivery shipments.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the order.",
            "schema": {
              "type": "string",
              "example": "P10GRL"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Detailed information for the requested order.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "order": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "P10GRL"
                        },
                        "customerName": {
                          "type": "string",
                          "example": "John Doe"
                        },
                        "customerPhone": {
                          "type": "string",
                          "example": "01774452222"
                        },
                        "customerEmail": {
                          "type": "string",
                          "nullable": true
                        },
                        "customerId": {
                          "type": "string",
                          "nullable": true
                        },
                        "shippingAddress": {
                          "type": "string",
                          "example": "123 Test Street"
                        },
                        "totalAmount": {
                          "type": "number",
                          "example": 5318
                        },
                        "shippingCharge": {
                          "type": "number",
                          "example": 110
                        },
                        "discountAmount": {
                          "type": "number",
                          "example": 0
                        },
                        "notes": {
                          "type": "string",
                          "nullable": true
                        },
                        "city": {
                          "type": "string"
                        },
                        "zone": {
                          "type": "string"
                        },
                        "area": {
                          "type": "string",
                          "nullable": true
                        },
                        "cityName": {
                          "type": "string"
                        },
                        "zoneName": {
                          "type": "string"
                        },
                        "areaName": {
                          "type": "string",
                          "nullable": true
                        },
                        "status": {
                          "type": "string",
                          "example": "pending"
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time"
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "productId": {
                                "type": "string"
                              },
                              "variantId": {
                                "type": "string",
                                "nullable": true
                              },
                              "quantity": {
                                "type": "integer",
                                "example": 1
                              },
                              "price": {
                                "type": "number",
                                "example": 5208
                              },
                              "productName": {
                                "type": "string",
                                "example": "Amazfit Bip 5 Smart Watch"
                              },
                              "productImage": {
                                "type": "string",
                                "nullable": true,
                                "example": "https://cdn.scalius.com/image.png"
                              },
                              "variantSize": {
                                "type": "string",
                                "nullable": true
                              },
                              "variantColor": {
                                "type": "string",
                                "nullable": true,
                                "example": "Black"
                              }
                            }
                          }
                        },
                        "shipments": {
                          "type": "array",
                          "description": "A list of delivery shipments associated with this order.",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "providerId": {
                                "type": "string"
                              },
                              "providerType": {
                                "type": "string",
                                "example": "pathao"
                              },
                              "trackingId": {
                                "type": "string",
                                "nullable": true
                              },
                              "status": {
                                "type": "string"
                              },
                              "createdAt": {
                                "type": "string",
                                "format": "date-time"
                              }
                            }
                          },
                          "example": []
                        },
                        "deliveryProviders": {
                          "type": "array",
                          "description": "A list of currently active delivery providers that a shipment can be created with.",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "name": {
                                "type": "string"
                              },
                              "type": {
                                "type": "string"
                              },
                              "isActive": {
                                "type": "boolean"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "404": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      },
      "put": {
        "tags": [
          "Orders"
        ],
        "summary": "Update an existing order",
        "description": "Updates the details of an existing order. This operation recalculates stock based on changes to the item list (restoring stock for removed items and decrementing for new ones).",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the order to update.",
            "schema": {
              "type": "string",
              "example": "P10GRL"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/OrderPostRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Order updated successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "example": "P10GRL"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "404": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      },
      "delete": {
        "tags": [
          "Orders"
        ],
        "summary": "Soft delete an order",
        "description": "Marks an order as deleted by setting the `deletedAt` timestamp. It also restores the stock for all items in the order.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the order to soft delete.",
            "schema": {
              "type": "string",
              "example": "P10GRL"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Order soft-deleted successfully."
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "404": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/orders/{id}/items": {
      "get": {
        "tags": [
          "Orders"
        ],
        "summary": "Get an order's items",
        "description": "A lightweight endpoint to quickly fetch just the line items for a specific order, useful for UI elements like popovers in an order list.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the order.",
            "schema": {
              "type": "string",
              "example": "P10GRL"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A list of items in the order.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "productId": {
                        "type": "string"
                      },
                      "variantId": {
                        "type": "string",
                        "nullable": true
                      },
                      "quantity": {
                        "type": "integer"
                      },
                      "price": {
                        "type": "number"
                      },
                      "productName": {
                        "type": "string"
                      },
                      "productImage": {
                        "type": "string",
                        "nullable": true
                      },
                      "variantSize": {
                        "type": "string",
                        "nullable": true
                      },
                      "variantColor": {
                        "type": "string",
                        "nullable": true
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/orders/products-for-form": {
      "get": {
        "tags": [
          "Orders"
        ],
        "summary": "Get products for order creation form",
        "description": "Returns a list of all active products and their variants, structured specifically for populating a product selection dropdown or search in an order creation/editing form.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "A list of products with their nested variants.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "products": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "price": {
                            "type": "number"
                          },
                          "discountPercentage": {
                            "type": "number",
                            "nullable": true
                          },
                          "variants": {
                            "type": "array",
                            "items": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "string"
                                },
                                "productId": {
                                  "type": "string"
                                },
                                "size": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "color": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "weight": {
                                  "type": "number",
                                  "nullable": true
                                },
                                "sku": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "price": {
                                  "type": "number",
                                  "nullable": true
                                },
                                "stock": {
                                  "type": "integer"
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/orders/bulk-delete": {
      "post": {
        "tags": [
          "Orders"
        ],
        "summary": "Bulk delete orders",
        "description": "Soft deletes or permanently deletes multiple orders at once. Stock is restored for all items in the deleted orders.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "orderIds"
                ],
                "properties": {
                  "orderIds": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": [
                      "P10GRL",
                      "T6UWMI"
                    ],
                    "minItems": 1
                  },
                  "permanent": {
                    "type": "boolean",
                    "default": false,
                    "description": "If true, permanently deletes the orders from the database. If false (default), orders are soft-deleted."
                  }
                }
              }
            }
          }
        },
        "responses": {
          "204": {
            "description": "Orders deleted successfully."
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/orders/{id}/restore": {
      "post": {
        "tags": [
          "Orders"
        ],
        "summary": "Restore a soft-deleted order",
        "description": "Restores a soft-deleted order by clearing its `deletedAt` timestamp. It also decrements the stock for all items in the order.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the order to restore.",
            "schema": {
              "type": "string",
              "example": "P10GRL"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Order restored successfully."
          },
          "400": {
            "description": "Bad Request - The order is not deleted."
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "404": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/orders/{id}/status": {
      "put": {
        "tags": [
          "Orders"
        ],
        "summary": "Update an order's status",
        "description": "Quickly updates the status of a single order.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the order.",
            "schema": {
              "type": "string",
              "example": "P10GRL"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "status"
                ],
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": [
                      "pending",
                      "processing",
                      "confirmed",
                      "shipped",
                      "delivered",
                      "cancelled",
                      "returned"
                    ],
                    "example": "confirmed"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Order status updated successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "message": {
                          "type": "string",
                          "example": "Order status updated successfully"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/orders/{id}/permanent": {
      "delete": {
        "tags": [
          "Orders"
        ],
        "summary": "Permanently delete an order",
        "description": "Permanently removes an order and its associated items from the database. If the order was not already soft-deleted, stock will be restored first. This action is irreversible.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the order to permanently delete.",
            "schema": {
              "type": "string",
              "example": "P10GRL"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Order permanently deleted successfully."
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "404": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/health": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "Health check",
        "description": "Returns the health status of the API",
        "responses": {
          "200": {
            "description": "API is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "ok"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-06-30T18:30:26.054Z"
                    },
                    "version": {
                      "type": "string",
                      "example": "0.0.1"
                    },
                    "environment": {
                      "type": "string",
                      "example": "development"
                    },
                    "uptime": {
                      "type": "number",
                      "example": 108537.029673125
                    },
                    "cache": {
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "example": "redis"
                        },
                        "redisAvailable": {
                          "type": "boolean",
                          "example": true
                        },
                        "size": {
                          "type": "number",
                          "example": 24
                        },
                        "memory": {
                          "type": "string",
                          "example": "114.278KB"
                        },
                        "hitRate": {
                          "type": "string",
                          "example": "68.91%"
                        },
                        "missRate": {
                          "type": "string",
                          "example": "31.09%"
                        },
                        "uptime": {
                          "type": "string",
                          "example": "0d 0h 0m 0s"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/hero/sliders": {
      "get": {
        "tags": [
          "Hero"
        ],
        "summary": "Get hero sliders",
        "description": "Returns hero sliders based on device type or specific type requested",
        "parameters": [
          {
            "name": "type",
            "in": "query",
            "required": false,
            "description": "Filter by slider type (desktop or mobile)",
            "schema": {
              "type": "string",
              "enum": [
                "desktop",
                "mobile"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved hero sliders",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "desktop": {
                      "type": "object",
                      "nullable": true,
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "type": {
                          "type": "string"
                        },
                        "images": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "url": {
                                "type": "string"
                              },
                              "alt": {
                                "type": "string"
                              },
                              "link": {
                                "type": "string",
                                "nullable": true
                              }
                            }
                          }
                        },
                        "isActive": {
                          "type": "boolean"
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        }
                      }
                    },
                    "mobile": {
                      "type": "object",
                      "nullable": true,
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "type": {
                          "type": "string"
                        },
                        "images": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "url": {
                                "type": "string"
                              },
                              "alt": {
                                "type": "string"
                              },
                              "link": {
                                "type": "string",
                                "nullable": true
                              }
                            }
                          }
                        },
                        "isActive": {
                          "type": "boolean"
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        }
                      }
                    },
                    "images": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "url": {
                            "type": "string"
                          },
                          "alt": {
                            "type": "string"
                          },
                          "link": {
                            "type": "string",
                            "nullable": true
                          }
                        }
                      }
                    },
                    "isMobile": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/hero/sliders/{id}": {
      "get": {
        "tags": [
          "Hero"
        ],
        "summary": "Get hero slider by ID",
        "description": "Returns a specific hero slider by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "Slider ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved hero slider",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "slider": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "type": {
                          "type": "string"
                        },
                        "images": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "url": {
                                "type": "string"
                              },
                              "alt": {
                                "type": "string"
                              },
                              "link": {
                                "type": "string",
                                "nullable": true
                              }
                            }
                          }
                        },
                        "isActive": {
                          "type": "boolean"
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Hero slider not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/search": {
      "get": {
        "tags": [
          "Search"
        ],
        "summary": "Search products, categories, and pages",
        "description": "Search across multiple content types with various filters",
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "description": "Search query string",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "categoryId",
            "in": "query",
            "description": "Filter products by category ID",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "minPrice",
            "in": "query",
            "description": "Minimum price for product results",
            "required": false,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "maxPrice",
            "in": "query",
            "description": "Maximum price for product results",
            "required": false,
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "Maximum number of results to return per content type",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 10
            }
          },
          {
            "name": "searchPages",
            "in": "query",
            "description": "Whether to include pages in search results",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true"
            }
          },
          {
            "name": "searchCategories",
            "in": "query",
            "description": "Whether to include categories in search results",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "true",
                "false"
              ],
              "default": "true"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully performed search",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "products": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "prod_123"
                          },
                          "name": {
                            "type": "string",
                            "example": "Product Name"
                          },
                          "description": {
                            "type": "string",
                            "nullable": true,
                            "example": "Product description text"
                          },
                          "price": {
                            "type": "number",
                            "example": 1000
                          },
                          "slug": {
                            "type": "string",
                            "example": "product-name"
                          },
                          "imageUrl": {
                            "type": "string",
                            "nullable": true,
                            "example": "https://cdn.scalius.com/image.png"
                          },
                          "categoryId": {
                            "type": "string",
                            "example": "cat_123"
                          },
                          "categoryName": {
                            "type": "string",
                            "nullable": true,
                            "example": "Category Name"
                          },
                          "type": {
                            "type": "string",
                            "example": "product"
                          }
                        }
                      }
                    },
                    "categories": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "cat_123"
                          },
                          "name": {
                            "type": "string",
                            "example": "Category Name"
                          },
                          "slug": {
                            "type": "string",
                            "example": "category-name"
                          },
                          "description": {
                            "type": "string",
                            "nullable": true,
                            "example": "Category description"
                          },
                          "type": {
                            "type": "string",
                            "example": "category"
                          }
                        }
                      }
                    },
                    "pages": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "page_123"
                          },
                          "title": {
                            "type": "string",
                            "example": "Page Title"
                          },
                          "slug": {
                            "type": "string",
                            "example": "page-title"
                          },
                          "content": {
                            "type": "string",
                            "example": "Page content text"
                          },
                          "type": {
                            "type": "string",
                            "example": "page"
                          }
                        }
                      }
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "query": {
                      "type": "string",
                      "example": "search query"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2023-07-01T12:00:00Z"
                    }
                  }
                }
              }
            }
          },
          "429": {
            "description": "Too Many Requests - Rate limit exceeded",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to perform search",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/search/reindex": {
      "post": {
        "tags": [
          "Search"
        ],
        "summary": "Reindex all searchable content",
        "description": "Manually trigger reindexing of all products, categories, and pages",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully reindexed content",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "productsCount": {
                      "type": "integer",
                      "example": 100
                    },
                    "categoriesCount": {
                      "type": "integer",
                      "example": 10
                    },
                    "pagesCount": {
                      "type": "integer",
                      "example": 5
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Successfully reindexed all data"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2023-07-01T12:00:00Z"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid authorization",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to reindex content",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/header": {
      "get": {
        "tags": [
          "Header"
        ],
        "summary": "Get header data",
        "description": "Returns header configuration including logo, contact info, and social links",
        "responses": {
          "200": {
            "description": "Successfully retrieved header data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "header": {
                      "type": "object",
                      "properties": {
                        "topBar": {
                          "type": "object",
                          "properties": {
                            "text": {
                              "type": "string",
                              "example": "Free shipping on all orders over ৳1000"
                            }
                          }
                        },
                        "logo": {
                          "type": "object",
                          "properties": {
                            "src": {
                              "type": "string",
                              "example": "https://cdn.scalius.com/logo.png"
                            },
                            "alt": {
                              "type": "string",
                              "example": "Store Logo"
                            }
                          }
                        },
                        "favicon": {
                          "type": "object",
                          "nullable": true,
                          "properties": {
                            "src": {
                              "type": "string"
                            },
                            "alt": {
                              "type": "string"
                            }
                          }
                        },
                        "contact": {
                          "type": "object",
                          "properties": {
                            "phone": {
                              "type": "string",
                              "example": "+8801700000000"
                            },
                            "text": {
                              "type": "string",
                              "example": "Customer Support"
                            }
                          }
                        },
                        "social": {
                          "type": "object",
                          "properties": {
                            "facebook": {
                              "type": "string",
                              "example": "https://facebook.com/storepage"
                            }
                          }
                        }
                      }
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Header configuration not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch header data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/footer": {
      "get": {
        "tags": [
          "Footer"
        ],
        "summary": "Get footer data",
        "description": "Returns footer configuration including logo, menus, and social links",
        "responses": {
          "200": {
            "description": "Successfully retrieved footer data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "object",
                      "properties": {
                        "logo": {
                          "type": "object",
                          "properties": {
                            "src": {
                              "type": "string"
                            },
                            "alt": {
                              "type": "string"
                            }
                          }
                        },
                        "tagline": {
                          "type": "string"
                        },
                        "copyrightText": {
                          "type": "string"
                        },
                        "menus": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "title": {
                                "type": "string"
                              },
                              "links": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "title": {
                                      "type": "string"
                                    },
                                    "href": {
                                      "type": "string"
                                    },
                                    "subMenu": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "additionalProperties": true
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        },
                        "social": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "platform": {
                                "type": "string"
                              },
                              "url": {
                                "type": "string"
                              },
                              "icon": {
                                "type": "string"
                              }
                            }
                          }
                        },
                        "description": {
                          "type": "string"
                        }
                      }
                    },
                    "success": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Footer configuration not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch footer data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/navigation": {
      "get": {
        "tags": [
          "Navigation"
        ],
        "summary": "Get navigation menus",
        "description": "Returns navigation menu structure for header and/or footer",
        "parameters": [
          {
            "name": "type",
            "in": "query",
            "description": "Type of navigation to retrieve",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "header",
                "footer",
                "all"
              ],
              "default": "all"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved navigation data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "navigation": {
                      "type": "object",
                      "properties": {
                        "header": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "title": {
                                "type": "string",
                                "example": "Home"
                              },
                              "href": {
                                "type": "string",
                                "example": "/"
                              },
                              "subMenu": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "additionalProperties": true
                                }
                              }
                            }
                          }
                        },
                        "footer": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "example": "footer-menu-1"
                              },
                              "title": {
                                "type": "string",
                                "example": "Quick Links"
                              },
                              "links": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "additionalProperties": true
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Navigation configuration not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch navigation data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/navigation/{id}": {
      "get": {
        "tags": [
          "Navigation"
        ],
        "summary": "Get specific navigation menu by ID",
        "description": "Returns a specific navigation menu structure by ID",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "ID of the navigation menu to retrieve (header, footer, or a specific menu ID)",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved navigation menu",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "menu": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "example": "header"
                        },
                        "name": {
                          "type": "string",
                          "example": "Header Navigation"
                        },
                        "items": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "title": {
                                "type": "string",
                                "example": "Home"
                              },
                              "href": {
                                "type": "string",
                                "example": "/"
                              },
                              "subMenu": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "additionalProperties": true
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Navigation menu not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch navigation menu",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/pages": {
      "get": {
        "tags": [
          "Pages"
        ],
        "summary": "Get all pages",
        "description": "Returns a list of CMS pages with pagination",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "Number of pages to return",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 10
            }
          },
          {
            "name": "page",
            "in": "query",
            "description": "Page number for pagination",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "Sort field and direction (prefix with - for descending)",
            "required": false,
            "schema": {
              "type": "string",
              "enum": [
                "title",
                "createdAt",
                "-title",
                "-createdAt"
              ],
              "default": "title"
            }
          },
          {
            "name": "publishedOnly",
            "in": "query",
            "description": "Only return published pages",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved pages",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "pages": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "title": {
                            "type": "string"
                          },
                          "slug": {
                            "type": "string"
                          },
                          "content": {
                            "type": "string"
                          },
                          "metaTitle": {
                            "type": "string",
                            "nullable": true
                          },
                          "metaDescription": {
                            "type": "string",
                            "nullable": true
                          },
                          "isPublished": {
                            "type": "boolean"
                          },
                          "createdAt": {
                            "type": "number"
                          },
                          "updatedAt": {
                            "type": "number"
                          }
                        }
                      }
                    },
                    "pagination": {
                      "type": "object",
                      "properties": {
                        "page": {
                          "type": "number"
                        },
                        "limit": {
                          "type": "number"
                        },
                        "total": {
                          "type": "number"
                        },
                        "totalPages": {
                          "type": "number"
                        }
                      }
                    },
                    "success": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch pages",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/pages/slug/{slug}": {
      "get": {
        "tags": [
          "Pages"
        ],
        "summary": "Get page by slug",
        "description": "Returns a specific page by its slug",
        "parameters": [
          {
            "name": "slug",
            "in": "path",
            "description": "Slug of the page to retrieve",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved page",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "page": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "title": {
                          "type": "string"
                        },
                        "slug": {
                          "type": "string"
                        },
                        "content": {
                          "type": "string"
                        },
                        "metaTitle": {
                          "type": "string",
                          "nullable": true
                        },
                        "metaDescription": {
                          "type": "string",
                          "nullable": true
                        },
                        "isPublished": {
                          "type": "boolean"
                        },
                        "createdAt": {
                          "type": "number"
                        },
                        "updatedAt": {
                          "type": "number"
                        }
                      }
                    },
                    "success": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Page not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "500": {
            "description": "Server Error - Failed to fetch page",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/analytics/configurations": {
      "get": {
        "tags": [
          "Analytics"
        ],
        "summary": "Get active analytics configurations",
        "description": "Returns a list of all active analytics and tracking scripts (e.g., Google Analytics, Facebook Pixel) configured for the storefront. The `config` property for each script is dynamically processed on the server to be ready for injection, especially for scripts that use Partytown.",
        "responses": {
          "200": {
            "description": "Successfully retrieved analytics configurations.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "analytics": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "type": {
                            "type": "string",
                            "description": "e.g., 'google_analytics', 'facebook_pixel'"
                          },
                          "config": {
                            "type": "object",
                            "description": "The processed configuration or script content, ready for use."
                          },
                          "isActive": {
                            "type": "boolean"
                          },
                          "usePartytown": {
                            "type": "boolean"
                          },
                          "location": {
                            "type": "string",
                            "enum": [
                              "head",
                              "body_start",
                              "body_end"
                            ],
                            "description": "The recommended location to inject the script in the HTML."
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/stats": {
      "get": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Get cache statistics",
        "description": "Retrieves statistics about the API cache (Redis or in-memory fallback). This is useful for monitoring the health and performance of the caching layer. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Cache statistics retrieved successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "stats": {
                      "type": "object",
                      "properties": {
                        "size": {
                          "type": "number",
                          "description": "Number of keys in the cache."
                        },
                        "memory": {
                          "type": "string",
                          "description": "Approximate memory usage."
                        },
                        "hitRate": {
                          "type": "string",
                          "nullable": true
                        },
                        "missRate": {
                          "type": "string",
                          "nullable": true
                        },
                        "uptime": {
                          "type": "string",
                          "description": "Cache server uptime."
                        },
                        "cacheType": {
                          "type": "string",
                          "enum": [
                            "redis",
                            "memory"
                          ]
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the entire API cache",
        "description": "Invalidates the entire API cache for all resources. This is a powerful action that should be used with caution, for example, after a major deployment or data migration. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-products": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the product cache",
        "description": "Invalidates all cached data related to products, including product lists (PLP) and individual product details (PDP). Use this after creating, updating, or deleting any product. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Product cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-categories": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the category cache",
        "description": "Invalidates all cached data related to categories. Use this after creating, updating, or deleting any category. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Category cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-collections": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the collections cache",
        "description": "Invalidates cached data for homepage collections (e.g., featured product carousels). Use this after changing collection settings. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Collections cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-footer": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the footer cache",
        "description": "Invalidates cached data for the site footer. Use this after updating footer content or links. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Footer cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-header": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the header cache",
        "description": "Invalidates cached data for the site header. Use this after updating header content or navigation. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Header cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-hero": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the hero section cache",
        "description": "Invalidates cached data for the homepage hero section and sliders. Use this after updating hero content. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Hero cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-navigation": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the navigation cache",
        "description": "Invalidates cached data for all navigation menus (header, footer, etc.). Use this after changing menu structures. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Navigation cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-pages": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the CMS pages cache",
        "description": "Invalidates cached data for all static CMS pages. Use this after updating page content. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Pages cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/cache/clear-search": {
      "post": {
        "tags": [
          "Cache Management"
        ],
        "summary": "Clear the search cache",
        "description": "Invalidates cached search results. This is useful if underlying product or page data has changed, but you don't want to clear the entire product/page cache. Requires admin authentication.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Search cache cleared successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/discounts/validate": {
      "get": {
        "tags": [
          "Discounts"
        ],
        "summary": "Validate a discount code",
        "description": "Checks if a discount code is valid and active. It can also calculate the discount amount based on the current cart total, items, and shipping cost. This is typically used in the cart or checkout page before applying a discount.\n\n**Collection Support**: Discounts can be applied to specific products, collections, or both. Collections are automatically expanded to include all products from their associated categories (config.categoryIds) plus any specifically selected products (config.productIds). This ensures collection-based discounts work correctly.",
        "parameters": [
          {
            "name": "code",
            "in": "query",
            "required": true,
            "description": "The discount code to validate.",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "total",
            "in": "query",
            "required": false,
            "description": "The current order total (subtotal + shipping).",
            "schema": {
              "type": "number"
            }
          },
          {
            "name": "items",
            "in": "query",
            "required": false,
            "description": "A JSON string of cart items. Required for product-specific and collection-based discounts. Collections are automatically expanded to their products. Example: `[{\"id\":\"prod_123\",\"price\":100,\"quantity\":1}]`",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "shippingCost",
            "in": "query",
            "required": false,
            "description": "The current shipping cost. Required for `free_shipping` discounts.",
            "schema": {
              "type": "number",
              "default": 0
            }
          },
          {
            "name": "customerPhone",
            "in": "query",
            "required": false,
            "description": "Customer's phone number, used for 'limit one per customer' validation.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "The result of the discount validation.",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "type": "object",
                      "title": "Valid Discount",
                      "properties": {
                        "valid": {
                          "type": "boolean",
                          "example": true
                        },
                        "discount": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "code": {
                              "type": "string"
                            },
                            "type": {
                              "type": "string"
                            },
                            "valueType": {
                              "type": "string"
                            },
                            "discountValue": {
                              "type": "number"
                            },
                            "combinable": {
                              "type": "object",
                              "description": "Rules for combining this discount with others.",
                              "properties": {
                                "withProductDiscounts": {
                                  "type": "boolean"
                                },
                                "withOrderDiscounts": {
                                  "type": "boolean"
                                },
                                "withShippingDiscounts": {
                                  "type": "boolean"
                                }
                              }
                            }
                          }
                        },
                        "discountAmount": {
                          "type": "number",
                          "description": "The calculated discount value."
                        }
                      }
                    },
                    {
                      "type": "object",
                      "title": "Invalid Discount",
                      "properties": {
                        "valid": {
                          "type": "boolean",
                          "example": false
                        },
                        "error": {
                          "type": "string",
                          "description": "Reason why the discount is invalid."
                        },
                        "minPurchaseAmount": {
                          "type": "number",
                          "nullable": true,
                          "description": "The minimum purchase amount required, if applicable."
                        },
                        "minQuantity": {
                          "type": "number",
                          "nullable": true,
                          "description": "The minimum item quantity required, if applicable."
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/discounts/usage": {
      "post": {
        "tags": [
          "Discounts"
        ],
        "summary": "Record discount usage",
        "description": "Records that a discount code was used in an order. This should be called after an order is successfully created.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "discountId",
                  "orderId",
                  "amountDiscounted"
                ],
                "properties": {
                  "discountId": {
                    "type": "string"
                  },
                  "orderId": {
                    "type": "string"
                  },
                  "customerId": {
                    "type": "string",
                    "nullable": true
                  },
                  "amountDiscounted": {
                    "type": "number"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successfully recorded discount usage.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "id": {
                      "type": "string",
                      "description": "The ID of the new discount usage record."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/locations/cities": {
      "get": {
        "tags": [
          "Locations"
        ],
        "summary": "Get all delivery cities",
        "description": "Returns a list of all active cities available for delivery. This is the first step in a hierarchical location selector (City -> Zone -> Area).",
        "responses": {
          "200": {
            "description": "A list of active cities.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "type": {
                            "type": "string",
                            "example": "city"
                          },
                          "parentId": {
                            "type": "string",
                            "nullable": true
                          },
                          "isActive": {
                            "type": "boolean"
                          },
                          "sortOrder": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/locations/zones": {
      "get": {
        "tags": [
          "Locations"
        ],
        "summary": "Get delivery zones for a city",
        "description": "Returns a list of all active zones for a specified city ID. Call this after the user has selected a city.",
        "parameters": [
          {
            "name": "cityId",
            "in": "query",
            "required": true,
            "description": "The ID of the parent city.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A list of active zones for the specified city.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "type": {
                            "type": "string",
                            "example": "zone"
                          },
                          "parentId": {
                            "type": "string"
                          },
                          "isActive": {
                            "type": "boolean"
                          },
                          "sortOrder": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/locations/areas": {
      "get": {
        "tags": [
          "Locations"
        ],
        "summary": "Get delivery areas for a zone",
        "description": "Returns a list of all active areas for a specified zone ID. Call this after the user has selected a zone. This step may be optional depending on `fieldVisibility` settings.",
        "parameters": [
          {
            "name": "zoneId",
            "in": "query",
            "required": true,
            "description": "The ID of the parent zone.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A list of active areas for the specified zone.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "type": {
                            "type": "string",
                            "example": "area"
                          },
                          "parentId": {
                            "type": "string"
                          },
                          "isActive": {
                            "type": "boolean"
                          },
                          "sortOrder": {
                            "type": "number"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/checkout-languages/active": {
      "get": {
        "tags": [
          "Checkout Languages"
        ],
        "summary": "Get the active checkout language",
        "description": "Returns the complete configuration for the active checkout language, including all text labels, placeholders, and rules for which form fields should be visible. This single endpoint provides all the necessary text and configuration to render the checkout page.",
        "responses": {
          "200": {
            "description": "The active checkout language configuration.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "language": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        },
                        "code": {
                          "type": "string"
                        },
                        "languageData": {
                          "type": "object",
                          "description": "All text labels and messages for the checkout page.",
                          "properties": {
                            "pageTitle": {
                              "type": "string"
                            },
                            "checkoutSectionTitle": {
                              "type": "string"
                            },
                            "cartSectionTitle": {
                              "type": "string"
                            },
                            "customerNameLabel": {
                              "type": "string"
                            },
                            "customerNamePlaceholder": {
                              "type": "string"
                            },
                            "customerPhoneLabel": {
                              "type": "string"
                            },
                            "customerPhonePlaceholder": {
                              "type": "string"
                            },
                            "customerPhoneHelp": {
                              "type": "string"
                            },
                            "customerEmailLabel": {
                              "type": "string"
                            },
                            "customerEmailPlaceholder": {
                              "type": "string"
                            },
                            "shippingAddressLabel": {
                              "type": "string"
                            },
                            "shippingAddressPlaceholder": {
                              "type": "string"
                            },
                            "cityLabel": {
                              "type": "string"
                            },
                            "zoneLabel": {
                              "type": "string"
                            },
                            "areaLabel": {
                              "type": "string"
                            },
                            "shippingMethodLabel": {
                              "type": "string"
                            },
                            "orderNotesLabel": {
                              "type": "string"
                            },
                            "orderNotesPlaceholder": {
                              "type": "string"
                            },
                            "subtotalText": {
                              "type": "string"
                            },
                            "shippingText": {
                              "type": "string"
                            },
                            "discountText": {
                              "type": "string"
                            },
                            "totalText": {
                              "type": "string"
                            },
                            "discountCodePlaceholder": {
                              "type": "string"
                            },
                            "applyDiscountText": {
                              "type": "string"
                            },
                            "removeDiscountText": {
                              "type": "string"
                            },
                            "placeOrderText": {
                              "type": "string"
                            },
                            "processingText": {
                              "type": "string"
                            },
                            "emptyCartText": {
                              "type": "string"
                            },
                            "continueShoppingText": {
                              "type": "string"
                            },
                            "termsText": {
                              "type": "string"
                            },
                            "processingOrderTitle": {
                              "type": "string"
                            },
                            "processingOrderMessage": {
                              "type": "string"
                            },
                            "requiredFieldIndicator": {
                              "type": "string"
                            }
                          }
                        },
                        "fieldVisibility": {
                          "type": "object",
                          "description": "Rules for showing or hiding optional form fields.",
                          "properties": {
                            "showEmailField": {
                              "type": "boolean"
                            },
                            "showOrderNotesField": {
                              "type": "boolean"
                            },
                            "showAreaField": {
                              "type": "boolean"
                            }
                          }
                        },
                        "isActive": {
                          "type": "boolean"
                        },
                        "isDefault": {
                          "type": "boolean"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/widgets/{id}": {
      "get": {
        "tags": [
          "Widgets"
        ],
        "summary": "Get a widget by ID",
        "description": "Returns a single active widget by its unique ID. The response includes the raw HTML and CSS content to be rendered on the storefront.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "description": "The unique ID of the widget.",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "The requested widget.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "widget": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string",
                          "description": "Internal name for the widget."
                        },
                        "htmlContent": {
                          "type": "string",
                          "description": "The raw HTML content of the widget."
                        },
                        "cssContent": {
                          "type": "string",
                          "nullable": true,
                          "description": "Optional CSS for the widget."
                        },
                        "isActive": {
                          "type": "boolean"
                        },
                        "displayTarget": {
                          "type": "string",
                          "enum": [
                            "homepage"
                          ]
                        },
                        "placementRule": {
                          "type": "string",
                          "enum": [
                            "before_collection",
                            "after_collection",
                            "fixed_top_homepage",
                            "fixed_bottom_homepage",
                            "standalone"
                          ]
                        },
                        "referenceCollectionId": {
                          "type": "string",
                          "nullable": true,
                          "description": "The ID of the collection this widget is placed relative to."
                        },
                        "sortOrder": {
                          "type": "number"
                        },
                        "createdAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        },
                        "updatedAt": {
                          "type": "string",
                          "format": "date-time",
                          "nullable": true
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/widgets/active/homepage": {
      "get": {
        "tags": [
          "Widgets"
        ],
        "summary": "Get all active homepage widgets",
        "description": "Returns a list of all active widgets configured for the homepage, sorted by their placement rule and sort order. The storefront can use this list to dynamically inject custom HTML/CSS content at various locations on the homepage.",
        "responses": {
          "200": {
            "description": "A list of active widgets for the homepage.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "widgets": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "htmlContent": {
                            "type": "string"
                          },
                          "cssContent": {
                            "type": "string",
                            "nullable": true
                          },
                          "isActive": {
                            "type": "boolean"
                          },
                          "displayTarget": {
                            "type": "string",
                            "enum": [
                              "homepage"
                            ]
                          },
                          "placementRule": {
                            "type": "string",
                            "enum": [
                              "before_collection",
                              "after_collection",
                              "fixed_top_homepage",
                              "fixed_bottom_homepage",
                              "standalone"
                            ]
                          },
                          "referenceCollectionId": {
                            "type": "string",
                            "nullable": true
                          },
                          "sortOrder": {
                            "type": "number"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "nullable": true
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time",
                            "nullable": true
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/seo": {
      "get": {
        "tags": [
          "SEO"
        ],
        "summary": "Get global SEO settings",
        "description": "Returns global SEO configuration for the site, including default titles, meta descriptions, and the content for `robots.txt`. This data is used for the site's overall SEO strategy and for pages that don't have their own specific metadata.",
        "responses": {
          "200": {
            "description": "Global SEO settings.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "siteTitle": {
                      "type": "string",
                      "nullable": true,
                      "description": "The general title for the entire site, used as a suffix or default."
                    },
                    "homepageTitle": {
                      "type": "string",
                      "nullable": true,
                      "description": "The specific SEO title for the homepage."
                    },
                    "homepageMetaDescription": {
                      "type": "string",
                      "nullable": true,
                      "description": "The specific meta description for the homepage."
                    },
                    "robotsTxt": {
                      "type": "string",
                      "nullable": true,
                      "description": "The raw content for the `robots.txt` file."
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/attributes/filterable": {
      "get": {
        "tags": [
          "Attributes"
        ],
        "summary": "Get filterable attributes and their values",
        "description": "Returns a list of attributes that can be used for filtering products, along with all unique values for each attribute.",
        "responses": {
          "200": {
            "description": "Successfully retrieved filterable attributes.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "filters": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "slug": {
                            "type": "string"
                          },
                          "values": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          }
                        },
                        "example": {
                          "id": "attr_123",
                          "name": "Brand",
                          "slug": "brand",
                          "values": [
                            "Samsung",
                            "Apple",
                            "Xiaomi"
                          ]
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/attributes/category/{categoryId}": {
      "get": {
        "tags": [
          "Attributes"
        ],
        "summary": "Get filterable attributes for a specific category",
        "description": "Returns all filterable attributes and their values that exist in products of the specified category.",
        "parameters": [
          {
            "name": "categoryId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The ID of the category"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved category attributes.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "filters": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "slug": {
                            "type": "string"
                          },
                          "values": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/attributes/category-slug/{categorySlug}": {
      "get": {
        "tags": [
          "Attributes"
        ],
        "summary": "Get filterable attributes for a category by slug",
        "description": "Returns all filterable attributes and their values that exist in products of the specified category (identified by slug).",
        "parameters": [
          {
            "name": "categorySlug",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "The slug of the category"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved category attributes.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "filters": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "slug": {
                            "type": "string"
                          },
                          "values": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Category not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/attributes/search-filters": {
      "get": {
        "tags": [
          "Attributes"
        ],
        "summary": "Get filterable attributes for search results",
        "description": "Returns all filterable attributes and their values that exist in products matching the search query. Useful for showing filters on search result pages.",
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "Search query to find matching products"
          },
          {
            "name": "categoryId",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            },
            "description": "Optional: Limit search to a specific category"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved search filters.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "filters": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string"
                          },
                          "name": {
                            "type": "string"
                          },
                          "slug": {
                            "type": "string"
                          },
                          "values": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  },
                  "example": {
                    "filters": [
                      {
                        "id": "attr_123",
                        "name": "Brand",
                        "slug": "brand",
                        "values": [
                          "Samsung",
                          "Apple"
                        ]
                      },
                      {
                        "id": "attr_456",
                        "name": "Storage",
                        "slug": "storage",
                        "values": [
                          "128GB",
                          "256GB",
                          "512GB"
                        ]
                      }
                    ]
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/abandoned-checkouts": {
      "post": {
        "tags": [
          "Orders"
        ],
        "summary": "Create or update an abandoned checkout",
        "description": "Creates or updates a record of an incomplete checkout. This endpoint is designed to be called periodically by the storefront as a user fills out the checkout form. It uses an idempotent approach, where sending the same `checkoutId` multiple times will update the same record instead of creating new ones.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "checkoutId",
                  "checkoutData"
                ],
                "properties": {
                  "checkoutId": {
                    "type": "string",
                    "description": "A unique identifier for the user's checkout session, generated by the storefront.",
                    "example": "chk_session_12345abcde"
                  },
                  "customerPhone": {
                    "type": "string",
                    "description": "The customer's phone number, if entered.",
                    "example": "01712345678"
                  },
                  "checkoutData": {
                    "type": "object",
                    "description": "A JSON object containing all data captured from the checkout form, including cart items, customer details, etc.",
                    "example": {
                      "customerName": "John Doe",
                      "shippingAddress": "123 Main St",
                      "items": [
                        {
                          "productId": "prod_abc",
                          "quantity": 1,
                          "price": 1500
                        }
                      ]
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully saved the abandoned checkout data.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Abandoned checkout saved."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "$ref": "#/components/schemas/Error"
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/abandoned-checkouts/{checkoutId}": {
      "delete": {
        "tags": [
          "Orders"
        ],
        "summary": "Delete an abandoned checkout record",
        "description": "Deletes an abandoned checkout record, typically after a user successfully completes their order. This prevents completed orders from appearing as abandoned.",
        "parameters": [
          {
            "name": "checkoutId",
            "in": "path",
            "required": true,
            "description": "The unique identifier for the checkout session to be deleted.",
            "schema": {
              "type": "string"
            },
            "example": "chk_session_12345abcde"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully deleted the abandoned checkout record.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Abandoned checkout record deleted."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "$ref": "#/components/schemas/Error"
          }
        }
      }
    },
    "/meta/events": {
      "post": {
        "tags": [
          "Meta Conversions API"
        ],
        "summary": "Send a server-side event to Meta",
        "description": "Sends a single event to the Meta Conversions API. This endpoint is intended to be called from the storefront. The server handles fetching credentials, hashing PII data (like email and name) according to Meta's requirements, and logging the request. Providing more user data fields will improve the Event Match Quality (EMQ) and can lead to better ad performance and attribution.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": [
                  "eventName",
                  "eventSourceUrl",
                  "userData"
                ],
                "properties": {
                  "eventName": {
                    "type": "string",
                    "description": "A standard or custom event name (e.g., 'Purchase', 'ViewContent').",
                    "example": "Purchase"
                  },
                  "eventSourceUrl": {
                    "type": "string",
                    "description": "The URL of the page where the event occurred.",
                    "example": "https://yourstore.com/products/cool-widget"
                  },
                  "actionSource": {
                    "type": "string",
                    "description": "Where the conversion occurred. Defaults to 'website' if not provided.",
                    "enum": [
                      "website",
                      "app",
                      "offline",
                      "chat",
                      "physical_store",
                      "system_generated",
                      "business_messaging",
                      "other"
                    ],
                    "default": "website",
                    "example": "website"
                  },
                  "userData": {
                    "type": "object",
                    "description": "User identification data. Provide as many fields as possible to improve Event Match Quality. PII (like email, phone, name) will be hashed by the server automatically according to Meta's requirements.",
                    "required": [],
                    "properties": {
                      "em": {
                        "type": "string",
                        "description": "User's email address (unhashed).",
                        "example": "test@example.com"
                      },
                      "ph": {
                        "type": "string",
                        "description": "User's phone number (unhashed). Should include country code if possible.",
                        "example": "15551234567"
                      },
                      "fn": {
                        "type": "string",
                        "description": "User's first name (unhashed).",
                        "example": "john"
                      },
                      "ln": {
                        "type": "string",
                        "description": "User's last name (unhashed).",
                        "example": "smith"
                      },
                      "ge": {
                        "type": "string",
                        "description": "User's gender. 'f' for female or 'm' for male.",
                        "enum": [
                          "f",
                          "m"
                        ],
                        "example": "m"
                      },
                      "db": {
                        "type": "string",
                        "description": "User's date of birth in YYYYMMDD format.",
                        "example": "19901020"
                      },
                      "ct": {
                        "type": "string",
                        "description": "User's city (unhashed).",
                        "example": "menlo park"
                      },
                      "st": {
                        "type": "string",
                        "description": "User's state (unhashed). 2-letter ANSI code for US.",
                        "example": "ca"
                      },
                      "zp": {
                        "type": "string",
                        "description": "User's zip code.",
                        "example": "94025"
                      },
                      "country": {
                        "type": "string",
                        "description": "User's country. 2-letter ISO 3166-1 alpha-2 code.",
                        "example": "us"
                      },
                      "external_id": {
                        "type": "string",
                        "description": "A unique ID from your system for the user.",
                        "example": "user12345"
                      },
                      "client_ip_address": {
                        "type": "string",
                        "description": "User's IP address.",
                        "example": "123.123.123.123"
                      },
                      "client_user_agent": {
                        "type": "string",
                        "description": "User's browser user agent string.",
                        "example": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36"
                      },
                      "fbp": {
                        "type": "string",
                        "description": "The Facebook browser ID (_fbp cookie).",
                        "example": "fb.1.1558571054389.1098115397"
                      },
                      "fbc": {
                        "type": "string",
                        "description": "The Facebook click ID (_fbc cookie). Generated from fbclid URL parameter.",
                        "example": "fb.1.1554763741205.AbCdEfGhIjKlMnOpQrStUvWxYz1234567890"
                      },
                      "subscription_id": {
                        "type": "string",
                        "description": "The subscription ID for the user in a transaction.",
                        "example": "sub_1a2b3c"
                      },
                      "lead_id": {
                        "type": "number",
                        "description": "The ID associated with a lead generated from a Meta Lead Ad.",
                        "example": 123456789012345
                      }
                    }
                  },
                  "customData": {
                    "type": "object",
                    "description": "Event-specific data like value, currency, or contents.",
                    "properties": {
                      "value": {
                        "type": "number",
                        "description": "Monetary value of the event.",
                        "example": 99.99
                      },
                      "currency": {
                        "type": "string",
                        "description": "ISO 4217 currency code.",
                        "example": "USD"
                      },
                      "content_ids": {
                        "type": "array",
                        "items": {
                          "type": "string"
                        },
                        "description": "Array of product SKUs or IDs.",
                        "example": [
                          "PROD123",
                          "PROD456"
                        ]
                      },
                      "contents": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "quantity": {
                              "type": "number"
                            },
                            "item_price": {
                              "type": "number"
                            }
                          }
                        },
                        "description": "Detailed information about products in the event.",
                        "example": [
                          {
                            "id": "PROD123",
                            "quantity": 1,
                            "item_price": 49.99
                          },
                          {
                            "id": "PROD456",
                            "quantity": 2,
                            "item_price": 25
                          }
                        ]
                      },
                      "content_type": {
                        "type": "string",
                        "enum": [
                          "product",
                          "product_group"
                        ],
                        "example": "product"
                      },
                      "order_id": {
                        "type": "string",
                        "description": "The order or transaction ID. Important for purchase events.",
                        "example": "ORDER54321"
                      },
                      "search_string": {
                        "type": "string",
                        "description": "The user's search query.",
                        "example": "blue shoes"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Event successfully received and queued for processing.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Event received and is being processed."
                    },
                    "eventId": {
                      "type": "string",
                      "description": "The unique ID assigned to this event for server-side deduplication.",
                      "example": "cuid2_abcdefg12345"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - The provided payload was invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "503": {
            "description": "Service Unavailable - The Conversions API is not configured or enabled on the server.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    }
  }
}